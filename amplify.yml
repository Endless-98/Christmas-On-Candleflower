version: 1
applications:
  - appRoot: site
    frontend:
      phases:
        preBuild:
          commands:
            - node -v
            - npm ci || npm install
        build:
          commands:
            - npm run build
      artifacts:
        baseDirectory: dist
        files:
          - '**/*'
      cache:
        paths:
          - node_modules/**/*
    customHeaders:
      - pattern: '**/*'
        headers:
          - key: Cache-Control
            value: max-age=600
      - pattern: 'assets/**'
        headers:
          - key: Cache-Control
            value: public,max-age=31536000,immutable
    customRules:
      - source: https://christmasoncandleflower.com
        status: 302
        target: https://www.christmasoncandleflower.com
      - source: /<*>
        status: 404-200
        target: /index.html